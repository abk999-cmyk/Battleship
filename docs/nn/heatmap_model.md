## Supervised Heatmap CNN

Defines the convolutional network trained in `train_heatmap.py` to predict ship occupancy probability per cell from the agent-visible board state.

### Data
- Source: `data/battleship_supervised.pkl` generated by `generate_dataset.py` via self-play (`AI_agent.AIPlayer` vs `AIPlayer`).
- Each record: `(state_tensor, ship_grid)` where
  - `state_tensor`: 10×10×3 float16 (planes: miss, hit, unknown), encoded from agent `result_grid`.
  - `ship_grid`: 10×10 int8 label with 1 at true ship coordinates and 0 elsewhere.

### Model
```
Input  (10,10,3)
Conv2D 64,3×3,relu,same
Conv2D 64,3×3,relu,same
Conv2D 64,3×3,relu,same
Conv2D 1 ,1×1,sigmoid,same → (10,10,1)
```
- Loss: Binary cross-entropy on per-cell labels.
- Optimizer: Adam(1e-3); epochs≈12; batch=256; train/val split=90/10.
- Output: `models/battleship_heatmap.h5` (Keras SavedModel H5).

### Inference contract
- Input planes M/H/U constructed from current `result_grid`.
- Output 10×10 heatmap aligned to board indices; masked to `available_moves` before use.
- Agents optionally normalize and blend with other grids (density, MC) using per-mode weights.

### Scientific framing
- The CNN learns a prior over latent ship configurations conditional on partial observations. Because labels include all true ship cells (not just the next hit), the model captures global structure (fleet shapes, placement priors) rather than one-step Q-values.

### Limitations
- Training distribution depends on self-play policy (Agent 1); bias mitigated by RL fine-tuning and GA blending later.
- No rotation/flip data aug in baseline script; could be added for invariance.
